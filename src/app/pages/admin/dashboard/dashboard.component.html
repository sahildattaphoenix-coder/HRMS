<div class="dashboard-wrapper">
  <!-- Stats Row (Admin) -->
  <div class="row g-3 mb-4">
    <div class="col-xl-3 col-md-6 col-12">
      <div class="stat-card shadow-sm border-0">
        <div class="icon-box bg-red-soft"><i class="bi bi-people"></i></div>
        <div class="stat-content">
          <span class="stat-val">{{ adminStats.teamCount }}</span>
          <span class="stat-label">My Team</span>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6 col-12">
      <div class="stat-card shadow-sm border-0">
        <div class="icon-box bg-blue-pale-soft"><i class="bi bi-person-check"></i></div>
        <div class="stat-content">
          <span class="stat-val">{{ adminStats.active }}</span>
          <span class="stat-label">Active</span>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6 col-12">
      <div class="stat-card shadow-sm border-0">
        <div class="icon-box bg-yellow-soft"><i class="bi bi-house-door"></i></div>
        <div class="stat-content">
          <span class="stat-val">{{ adminStats.wfh }}</span>
          <span class="stat-label">WFH</span>
        </div>
      </div>
    </div>
    <div class="col-xl-3 col-md-6 col-12">
      <div class="stat-card shadow-sm border-0">
        <div class="icon-box bg-red-vivid-soft"><i class="bi bi-person-x"></i></div>
        <div class="stat-content">
          <span class="stat-val">{{ adminStats.absent }}</span>
          <span class="stat-label">Absent</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Row -->
  <div class="row g-2 mb-4">
    <div class="col-lg-5">
      <div class="chart-container shadow-sm p-4">
        <h6 class="chart-title mb-4">Attendance Performances</h6>
        <apx-chart
          [series]="barChartOptions.series"
          [chart]="barChartOptions.chart"
          [plotOptions]="barChartOptions.plotOptions"
          [colors]="barChartOptions.colors"
          [xaxis]="barChartOptions.xaxis"
          [dataLabels]="barChartOptions.dataLabels"
        ></apx-chart>
        <div class="chart-legend d-flex justify-content-center gap-4 mt-3">
          <span class="legend-item"
            ><span class="dot bg-success"></span>Present</span
          >
          <span class="legend-item"
            ><span class="dot bg-grey"></span>Absent</span
          >
          <span class="legend-item"
            ><span class="dot bg-danger"></span>Off</span
          >
        </div>
      </div>
    </div>
    <div class="col-lg-7">
      <div class="chart-container shadow-sm p-4">
        <h6 class="chart-title mb-4">My Current Project</h6>
        <div class="d-flex align-items-center flex-wrap gap-2">
          <div class="pie-wrapper flex-grow-1">
            <apx-chart
              [series]="pieChartOptions.series"
              [chart]="pieChartOptions.chart"
              [labels]="pieChartOptions.labels"
              [colors]="pieChartOptions.colors"
              [responsive]="pieChartOptions.responsive"
              [legend]="pieChartOptions.legend"
            ></apx-chart>
          </div>
          <div class="project-info-card shadow-sm p-4 rounded-4 text-center">
            <span class="d-block text-muted small mb-2">Project 1</span>
            <div class="project-pill bg-white py-2 px-3 rounded shadow-sm">
              <span class="fw-bold text-primary smallest">HRMS PROJECT</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4 mb-4">
    <!-- Left: Leave Summary -->
    <div class="col-lg-3">
      <div class="content-box shadow-sm p-4 h-100">
        <h6 class="chart-title mb-4">Leave summery</h6>
        <div
          class="d-flex flex-column align-items-center gap-4"
          *ngIf="leaveSummary"
        >
          <div
            class="leave-card w-100 text-center py-2 bg-light-blue rounded-3"
          >
            <span class="d-block text-muted small mb-1">Available leave</span>
          </div>

          <div
            class="circle-progress position-relative d-flex align-items-center justify-content-center"
          >
            <svg width="120" height="120">
              <circle
                cx="60"
                cy="60"
                r="54"
                fill="none"
                stroke="#e2e8f0"
                stroke-width="8"
              ></circle>
              <circle
                cx="60"
                cy="60"
                r="54"
                fill="none"
                stroke="#3b82f6"
                stroke-width="8"
                stroke-dasharray="340"
                [attr.stroke-dashoffset]="
                  340 - (340 * leaveSummary.balance) / leaveSummary.total
                "
              ></circle>
            </svg>
            <div class="circle-val fw-bold fs-4">
              {{ leaveSummary.balance }}
            </div>
          </div>

          <div class="w-100 d-flex flex-column gap-2">
            <div
              class="summary-pill bg-light text-muted py-2 px-3 rounded-pill small"
            >
              Taken leave - {{ leaveSummary.taken }}
            </div>
            <div
              class="summary-pill bg-light text-muted py-2 px-3 rounded-pill small"
            >
              Annual leave - {{ leaveSummary.total }}
            </div>
          </div>
        </div>
        <div *ngIf="!leaveSummary" class="text-center py-5 text-muted small">
          Loading summary...
        </div>
      </div>
    </div>

    <!-- Right: Combined Tables -->
    <div class="col-lg-9">
      <div class="content-box shadow-sm mb-4 overflow-hidden">
        <h6 class="chart-title p-4 pb-0 mb-0">Pending Approval by me</h6>
        <div class="table-responsive p-4">
          <table class="table text-center align-middle dashboard-table border">
            <thead>
              <tr>
                <th>Sr.No</th>
                <th>Em.Id</th>
                <th>Em.Name</th>
                <th>From Date</th>
                <th>To Date</th>
                <th>Leave Type</th>
                <th>Reasons</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody *ngIf="pendingApprovals.length > 0; else noPending">
              <tr *ngFor="let leave of pendingApprovals; let i = index">
                <td>{{ i + 1 }}</td>
                <td>{{ leave.employeeId }}</td>
                <td>{{ leave.employeeName }}</td>
                <td>{{ leave.startDate | date : "dd/MM/yyyy" }}</td>
                <td>{{ leave.endDate | date : "dd/MM/yyyy" }}</td>
                <td>{{ leave.type }}</td>
                <td class="text-muted text-truncate" style="max-width: 100px">
                  {{ leave.reason }}
                </td>
                <td>
                  <span
                    class="status-pill status-approved px-4 cursor-pointer"
                    routerLink="/admin/leave-requests"
                    >Action</span
                  >
                </td>
              </tr>
            </tbody>
            <ng-template #noPending>
              <tbody>
                <tr>
                  <td colspan="9" class="py-4 text-muted small">
                    No pending approvals.
                  </td>
                </tr>
              </tbody>
            </ng-template>
          </table>
        </div>
      </div>

      <div class="content-box shadow-sm overflow-hidden">
        <h6 class="chart-title p-4 pb-0 mb-0">My Pending Request</h6>
        <div class="table-responsive p-4">
          <table class="table text-center align-middle dashboard-table border">
            <thead>
              <tr>
                <th>ID</th>
                <th>Leave Type</th>
                <th>Name</th>
                <th>Short Summary</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody *ngIf="myPendingRequests.length > 0; else noMyRequests">
              <tr *ngFor="let leave of myPendingRequests">
                <td>{{ leave.id }}</td>
                <td>{{ leave.type }}</td>
                <td>{{ leave.employeeName }}</td>
                <td class="text-muted text-truncate" style="max-width: 150px">
                  {{ leave.reason }}
                </td>
                <td>
                  <span class="status-pill status-pending px-4">{{
                    leave.status
                  }}</span>
                </td>
              </tr>
            </tbody>
            <ng-template #noMyRequests>
              <tbody>
                <tr>
                  <td colspan="5" class="py-4 text-muted small">
                    No pending requests.
                  </td>
                </tr>
              </tbody>
            </ng-template>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="text-center py-4 text-muted small fw-bold">Copyright Dyotis</div>
</div>

    < ! - -   A d d / E d i t   P r o j e c t   M o d a l   - - >  
     < d i v   c l a s s = " c u s t o m - m o d a l - b a c k d r o p "   * n g I f = " s h o w A d d M o d a l "   ( c l i c k ) = " c l o s e M o d a l ( ) " > < / d i v >  
     < d i v   c l a s s = " c u s t o m - m o d a l   b g - w h i t e   r o u n d e d - 4   s h a d o w - l g   p - 4 "   * n g I f = " s h o w A d d M o d a l " >  
         < d i v   c l a s s = " d - f l e x   j u s t i f y - c o n t e n t - b e t w e e n   a l i g n - i t e m s - c e n t e r   m b - 4 " >  
             < h 5   c l a s s = " f w - b o l d   m - 0 " > { {   i s E d i t i n g   ?   ' E d i t '   :   ' C r e a t e '   } }   P r o j e c t < / h 5 >  
             < b u t t o n   c l a s s = " b t n - c l o s e   s h a d o w - n o n e "   ( c l i c k ) = " c l o s e M o d a l ( ) " > < / b u t t o n >  
         < / d i v >  
  
         < f o r m   [ f o r m G r o u p ] = " p r o j e c t F o r m "   ( n g S u b m i t ) = " o n S u b m i t P r o j e c t ( ) " >  
             < d i v   c l a s s = " r o w   g - 3 " >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                     < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > P r o j e c t   T i t l e < / l a b e l >  
                     < i n p u t   t y p e = " t e x t "   c l a s s = " f o r m - c o n t r o l   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " t i t l e " >  
                 < / d i v >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                     < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > M a n a g e r < / l a b e l >  
                     < i n p u t   t y p e = " t e x t "   c l a s s = " f o r m - c o n t r o l   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " m a n a g e r " >  
                 < / d i v >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                         < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > C a t e g o r y < / l a b e l >  
                         < s e l e c t   c l a s s = " f o r m - s e l e c t   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " c a t e g o r y " >  
                                 < o p t i o n   v a l u e = " W e b   D e v e l o p m e n t " > W e b   D e v e l o p m e n t < / o p t i o n >  
                                 < o p t i o n   v a l u e = " M o b i l e   A p p " > M o b i l e   A p p < / o p t i o n >  
                                 < o p t i o n   v a l u e = " D e s i g n " > D e s i g n < / o p t i o n >  
                                 < o p t i o n   v a l u e = " M a r k e t i n g " > M a r k e t i n g < / o p t i o n >  
                         < / s e l e c t >  
                 < / d i v >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                         < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > S t a t e < / l a b e l >  
                         < s e l e c t   c l a s s = " f o r m - s e l e c t   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " s t a t e " >  
                                 < o p t i o n   v a l u e = " A c t i v e " > A c t i v e < / o p t i o n >  
                                 < o p t i o n   v a l u e = " P e n d i n g " > P e n d i n g < / o p t i o n >  
                                 < o p t i o n   v a l u e = " C o m p l e t e d " > C o m p l e t e d < / o p t i o n >  
                         < / s e l e c t >  
                 < / d i v >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                     < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > S t a r t   D a t e < / l a b e l >  
                     < i n p u t   t y p e = " d a t e "   c l a s s = " f o r m - c o n t r o l   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " s t a r t D a t e " >  
                 < / d i v >  
                 < d i v   c l a s s = " c o l - m d - 6   t e x t - s t a r t " >  
                     < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e " > D e a d l i n e < / l a b e l >  
                     < i n p u t   t y p e = " d a t e "   c l a s s = " f o r m - c o n t r o l   r o u n d e d - 3 "   f o r m C o n t r o l N a m e = " d e a d l i n e " >  
                 < / d i v >  
  
                 < d i v   c l a s s = " c o l - 1 2   t e x t - s t a r t " >  
                         < l a b e l   c l a s s = " f o r m - l a b e l   s m a l l e s t   f w - b o l d   t e x t - m u t e d   t e x t - u p p e r c a s e   m b - 2 " > T e a m   M e m b e r s < / l a b e l >  
                         < d i v   c l a s s = " d - f l e x   f l e x - w r a p   g a p - 2   b o r d e r   p - 3   r o u n d e d - 3   b g - l i g h t "   s t y l e = " m a x - h e i g h t :   1 5 0 p x ;   o v e r f l o w - y :   a u t o ; " >  
                                 < d i v   * n g F o r = " l e t   e m p   o f   a l l E m p l o y e e s "    
                                           c l a s s = " d - f l e x   a l i g n - i t e m s - c e n t e r   g a p - 2   p - 2   r o u n d e d - p i l l   b o r d e r   b g - w h i t e   c u r s o r - p o i n t e r   s e l e c t - n o n e "  
                                           [ c l a s s . b o r d e r - p r i m a r y ] = " i s M e m b e r ( e m p . i d ) "  
                                           [ c l a s s . b g - b l u e - s o f t ] = " i s M e m b e r ( e m p . i d ) "  
                                           ( c l i c k ) = " t o g g l e T e a m M e m b e r ( e m p ) " >  
                                         < i m g   [ s r c ] = " e m p . i m g   | |   ' a s s e t s / i m a g e s / u s e r s / u s e r - 1 . j p g ' "   c l a s s = " r o u n d e d - c i r c l e "   w i d t h = " 2 4 "   h e i g h t = " 2 4 " >  
                                         < s p a n   c l a s s = " s m a l l e s t   f w - b o l d " > { {   e m p . n a m e   } } < / s p a n >  
                                         < i   c l a s s = " b i   b i - c h e c k - c i r c l e - f i l l   t e x t - p r i m a r y   m s - 1 "   * n g I f = " i s M e m b e r ( e m p . i d ) " > < / i >  
                                 < / d i v >  
                         < / d i v >  
                         < d i v   c l a s s = " f o r m - t e x t   s m a l l e s t " > C l i c k   t o   s e l e c t / d e s e l e c t   t e a m   m e m b e r s < / d i v >  
                 < / d i v >  
  
             < / d i v >  
  
             < d i v   c l a s s = " m t - 5   t e x t - e n d " >  
                 < b u t t o n   t y p e = " b u t t o n "   c l a s s = " b t n   b t n - l i g h t   r o u n d e d - p i l l   p x - 4   m e - 2 "   ( c l i c k ) = " c l o s e M o d a l ( ) " > C a n c e l < / b u t t o n >  
                 < b u t t o n   t y p e = " s u b m i t "   c l a s s = " b t n   b t n - p r i m a r y   r o u n d e d - p i l l   p x - 4 "   [ d i s a b l e d ] = " p r o j e c t F o r m . i n v a l i d " >  
                     { {   i s E d i t i n g   ?   ' U p d a t e '   :   ' C r e a t e '   } }   P r o j e c t  
                 < / b u t t o n >  
             < / d i v >  
         < / f o r m >  
     < / d i v >  
 